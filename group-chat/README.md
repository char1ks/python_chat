# ๐ญ ะะตะผะพะฝัััะฐัะธั ัะฒะพะปััะธะธ ัะฐัะฟัะตะดะตะปะตะฝะฝะพะน ัะธััะตะผั ัะฐัะฐ

ะญัะพั ะฟัะพะตะบั ะดะตะผะพะฝัััะธััะตั ัะฒะพะปััะธั ัะฐัะฟัะตะดะตะปะตะฝะฝะพะน ัะธััะตะผั ัะฐัะฐ ะธ ะฟัะพะฑะปะตะผั ั ะดะฐะฝะฝัะผะธ ะฒ ัะฐะทะฝัั ะฐััะธัะตะบัััะฐั.

## ๐ฏ ะฆะตะปั ะดะตะผะพะฝัััะฐัะธะธ

ะะพะบะฐะทะฐัั ัััะดะตะฝัะฐะผ ะบะฐะบ ัะฐะทะฒะธะฒะฐะตััั ะฐััะธัะตะบัััะฐ ัะธััะตะผั ะธ ะบะฐะบะธะต ะฟัะพะฑะปะตะผั ะฒะพะทะฝะธะบะฐัั:
- ะะพัะตัั ะดะฐะฝะฝัั ะฟัะธ ะฟะฐะดะตะฝะธะธ ัะตัะฒะตัะฐ
- ะัะพะฑะปะตะผั ั sticky sessions
- ะะฐะถะฝะพััั ะฒะฝะตัะฝะตะณะพ ััะฐะฝะธะปะธัะฐ (Redis)
- ะัะฐะฒะธะปัะฝะฐั ะฑะฐะปะฐะฝัะธัะพะฒะบะฐ ะฟะพ ะบะปััะฐะผ

## ๐ฎ ะะฒัะพะผะฐัะธัะตัะบะพะต ัะฐะทะดะตะปะตะฝะธะต ะฝะฐ ะณััะฟะฟั

ะะพะปัะทะพะฒะฐัะตะปะธ **ะฐะฒัะพะผะฐัะธัะตัะบะธ** ะดะตะปัััั ะฝะฐ 2 ะณััะฟะฟั ะฟะพ hash ะพั ะธั ID:
- ๐ต **ะััะฟะฟะฐ 1** - ะฟัะธะผะตัะฝะพ ะฟะพะปะพะฒะธะฝะฐ ะฟะพะปัะทะพะฒะฐัะตะปะตะน
- ๐ด **ะััะฟะฟะฐ 2** - ะฒัะพัะฐั ะฟะพะปะพะฒะธะฝะฐ ะฟะพะปัะทะพะฒะฐัะตะปะตะน

## ๐ญ ะกัะตะฝะฐัะธะธ ะดะตะผะพะฝัััะฐัะธะธ

### ๐ ะกัะตะฝะฐัะธะน 1: ะะดะธะฝ ะฑัะบัะฝะด (ะธััะพะดะฝะพะต ัะพััะพัะฝะธะต)
```bash
./run-scenario.sh 1
```
**ะงัะพ ะฟัะพะธััะพะดะธั:**
- ะะดะธะฝ backend ัะตัะฒะธั
- ะััะพัะธั ััะฐะฝะธััั ะฒ ะฟะฐะผััะธ
- ะัะต ัะฐะฑะพัะฐะตั ะฝะพัะผะฐะปัะฝะพ
- **ะกััะดะตะฝัั ะฒะธะดัั:** ัะฐั ัะฐะฑะพัะฐะตั, ะธััะพัะธั ัะพััะฐะฝัะตััั

### ๐ฅ ะกัะตะฝะฐัะธะน 2: ะะฐะดะตะฝะธะต ะฑัะบัะฝะดะฐ
```bash
./run-scenario.sh 2
```
**ะงัะพ ะฟัะพะธััะพะดะธั:**
- ะงะตัะตะท 30 ัะตะบัะฝะด backend ะฟะฐะดะฐะตั
- **ะกััะดะตะฝัั ะฒะธะดัั:** ัะตัะฒะธั ะฝะตะดะพัััะฟะตะฝ ๐ฑ

### ๐ ะกัะตะฝะฐัะธะน 3: ะะฒะฐ ะฑัะบัะฝะดะฐ + sticky sessions + Redis
```bash
./run-scenario.sh 3
```
**ะงัะพ ะฟัะพะธััะพะดะธั:**
- ะะฒะฐ backend ัะตัะฒะธัะฐ
- Sticky sessions ะฟะพ IP hash (nginx)
- ะััะพัะธั ัะตะฟะตัั ะฒ Redis
- **ะัะพะฑะปะตะผะฐ:** ะบะฐะถะดัะน backend ัะพััะฐะฝัะตั ัะพะปัะบะพ ัะฒะพะธ ัะพะพะฑัะตะฝะธั
- **ะกััะดะตะฝัั ะฒะธะดัั:** ะฝะตั ะฟะพะปะฝะพะน ะธััะพัะธะธ, ัะพะปัะบะพ ะฟะพะปะพะฒะธะฝะฐ ััะฐััะฝะธะบะพะฒ!

### ๐ฅ๐ฅ ะกัะตะฝะฐัะธะน 4: ะะพะปะฝะพะต ะฟะฐะดะตะฝะธะต
```bash
./run-scenario.sh 4
```
**ะงัะพ ะฟัะพะธััะพะดะธั:**
- ะงะตัะตะท 30 ัะตะบัะฝะด ะฒัะต ัะตัะฒะธัั ะฟะฐะดะฐัั
- **ะกััะดะตะฝัั ะฒะธะดัั:** ัะธััะตะผะฐ ะฟะพะปะฝะพัััั ะฝะตะดะพัััะฟะฝะฐ ๐ฑ๐ฑ

### ๐ ะกัะตะฝะฐัะธะน 5: ะะปะฐััะตั ะฒะพัััะฐะฝะพะฒะปะตะฝ + ะฟัะฐะฒะธะปัะฝะฐั ะฑะฐะปะฐะฝัะธัะพะฒะบะฐ
```bash
./run-scenario.sh 5
```
**ะงัะพ ะฟัะพะธััะพะดะธั:**
- ะะฐะปะฐะฝัะธัะพะฒะบะฐ ะฟะพ chat_id (ะฒัะต ะฒ ะพะดะธะฝ ัะฐั)
- ะัะต backend'ั ะฒะธะดัั ะฒัั ะธััะพัะธั ะธะท Redis
- **ะกััะดะตะฝัั ะฒะธะดัั:** ะฒัั ะธััะพัะธั ะฒะพัััะฐะฝะพะฒะปะตะฝะฐ! ะัะต ััะฐััะฝะธะบะธ ัะฝะพะฒะฐ ะฒ ัะฐัะต! ๐

## ๐ง ะขะตัะฝะธัะตัะบะธะต ะดะตัะฐะปะธ

### ะััะธัะตะบัััะฐ
```
[Nginx] โ [Backend 1]
       โ [Backend 2] โ [Redis]
```

### ะคะฐะนะปั ะบะพะฝัะธะณััะฐัะธะธ
- `docker-compose.scenario-1.yml` - ะพะดะธะฝ ะฑัะบัะฝะด
- `docker-compose.scenario-3.yml` - ะดะฒะฐ ะฑัะบัะฝะดะฐ + sticky sessions
- `docker-compose.scenario-5.yml` - ะฟัะฐะฒะธะปัะฝะฐั ะฑะฐะปะฐะฝัะธัะพะฒะบะฐ
- `nginx/scenario-*.conf` - ะบะพะฝัะธะณััะฐัะธะธ ะฑะฐะปะฐะฝัะธัะพะฒัะธะบะฐ

### ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั
- `BACKEND_ID` - ะธะดะตะฝัะธัะธะบะฐัะพั ะฑัะบัะฝะดะฐ (1 ะธะปะธ 2)
- `USE_REDIS` - ะธัะฟะพะปัะทะพะฒะฐัั ะปะธ Redis ะดะปั ััะฐะฝะตะฝะธั
- `REDIS_HOST` - ัะพัั Redis ัะตัะฒะตัะฐ

## ๐ ะะปั ะฟัะตะฟะพะดะฐะฒะฐัะตะปะตะน

### ะะพัะปะตะดะพะฒะฐัะตะปัะฝะพััั ะดะตะผะพะฝัััะฐัะธะธ:
1. **ะะฐะฟัััะธัะต ััะตะฝะฐัะธะน 1** - ะฟะพะบะฐะถะธัะต ััะพ ะฒัะต ัะฐะฑะพัะฐะตั
2. **ะะพะฟัะพัะธัะต ัััะดะตะฝัะพะฒ ะทะฐะนัะธ ะธ ะฟะพะฑะพะปัะฐัั** 
3. **ะะฐะฟัััะธัะต ััะตะฝะฐัะธะน 2** - ะฟะพะบะฐะถะธัะต ะฟะฐะดะตะฝะธะต
4. **ะะฐะฟัััะธัะต ััะตะฝะฐัะธะน 3** - ัััะดะตะฝัั ัะฒะธะดัั ะฟัะพะฑะปะตะผั ั ะดะฐะฝะฝัะผะธ
5. **ะะฐะฟัััะธัะต ััะตะฝะฐัะธะน 4** - ะฟะพะปะฝะพะต ะฟะฐะดะตะฝะธะต
6. **ะะฐะฟัััะธัะต ััะตะฝะฐัะธะน 5** - ะฒัะต ะฒะพัััะฐะฝะพะฒะปะตะฝะพ!

### ะะปััะตะฒัะต ะผะพะผะตะฝัั ะดะปั ะพะฑัััะฝะตะฝะธั:
- ะะฐะถะฝะพััั ะฒะฝะตัะฝะตะณะพ ััะฐะฝะธะปะธัะฐ ะดะฐะฝะฝัั
- ะัะพะฑะปะตะผั sticky sessions
- ะัะฐะฒะธะปัะฝะฐั ะฑะฐะปะฐะฝัะธัะพะฒะบะฐ ะฟะพ ะฑะธะทะฝะตั-ะบะปััะฐะผ
- ะัะบะฐะทะพัััะพะนัะธะฒะพััั ัะธััะตะผั

## ๐ ะัััััะน ััะฐัั

```bash
# ะะฐะฟััะบ ะฟะตัะฒะพะณะพ ััะตะฝะฐัะธั
./run-scenario.sh 1

# ะัะบัะพะนัะต http://localhost ะฒ ะฝะตัะบะพะปัะบะธั ะฒะบะปะฐะดะบะฐั
# ะะฐะถะดัะน ะฟะพะปัะทะพะฒะฐัะตะปั ะฟะพะฟะฐะดะตั ะฒ ัะปััะฐะนะฝัั ะณััะฟะฟั

# ะะปั ะฟะตัะตัะพะดะฐ ะบ ัะปะตะดัััะตะผั ััะตะฝะฐัะธั
./run-scenario.sh 3

# ะััะฐะฝะพะฒะบะฐ ะฒัะตั ัะตัะฒะธัะพะฒ
./run-scenario.sh stop
```

## ๐ ะะพะฝะธัะพัะธะฝะณ

```bash
# ะัะพัะผะพัั ะปะพะณะพะฒ
docker-compose logs -f

# ะัะพะฒะตัะบะฐ ััะฐัััะฐ
curl http://localhost/health

# ะัะพัะผะพัั Redis (ะฒ ััะตะฝะฐัะธัั 3 ะธ 5)
docker exec -it group-chat_redis_1 redis-cli
> KEYS chat_history:*
> LRANGE chat_history:group_1 0 -1
```

ะะฐัะปะฐะถะดะฐะนัะตัั ะดะตะผะพะฝัััะฐัะธะตะน! ๐ 